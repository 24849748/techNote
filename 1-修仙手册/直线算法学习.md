# 直线算法
* 数值微分法
* 中点法
* 贝斯曼直线算法

背景理解：
1. 在数学上，直线上有无数个点；在现实中，显示器的像素点是有限的
2. 在显示器上显示直线需要做一些处理
3. 竖线，横线最好处理，斜线需要经过算法处理
![Pasted image 20230430220842](https://raw.githubusercontent.com/24849748/PicBed/main/ob/202306091022043.png)

先验知识点：
* 直线方程：
$$1.y = kx+b$$
$$2.k=\cfrac{(y_1-y_0)}{(x_1-x_0)}(x_1\not\ne x_0)$$
* 因为像素点坐标必须是整数，所以必须涉及到计算机的**取整**问题（涉及补码反码）
* +0.5再取整可以达到数学上四舍五入的效果


为了在显示器上用各个点表示直线，需要计算出直线经过的像素点坐标
一般画点的步骤：
1. `k<1`
    1. 遍历x
    2. 计算`kx+b`
    3. 结果+0.5取整
2. `k>=1`
    1. 遍历y
    2. 计算`(y-b)/k`
    3. 结果+0.5取整

为什么要分`k<1` `k>=1`的情况？为了画出来的点更多，直线越明显
涉及到斜率k，就需要除法计算

所以上面的缺点：
1. 除法
2. 乘法
3. 浮点数

计算机处理加法很牛逼，其他运算相对没那么牛逼，那么优化的方向就是消除上面的缺点


### 数值微分法DDA
理解：引入增量思想，先计算第一第二点的增量k，后面的点就可以直接加k，通过增量减少后面乘法的计算
$$y_{i+1} = y_i+k$$
增量d等于斜率k，推导过程
![Pasted image 20230501000911](https://raw.githubusercontent.com/24849748/PicBed/main/ob/202306091024482.png)


画点步骤：
1. `k<1`
    1. 设起点(x0,y0)
    2. 算第二个点`(x0+1,y0+k)`
    3. `y0+k+0.5`后取整
2. `k>=1`
    1. 设起点(x0,y0)
    2. 算第二个点`(x0+1/k,y0+1)`
    3. `y0+k+0.5`后取整

缺陷：
1. 除法
2. 浮点数

优化：
* 用加法代替浮点计算
* 使用斜截式替代一般式$$y=kx+b => y-kx-b=0$$

### 中点法
理解：取当前直线经过的格子的中点做比较，决定下一个点在格子顶部还是底部

画点步骤：
* `k<1`
    * 设置起点(x0,y0)
    * 将中点(x0+1,y0+0.5)代入方程，算出中点与直线的距离d
    * d与0比较
        * 若`d<0`，中点在直线下面，下一点取上(x0+1,y0+1)
        * 若`d>=0`，中点在直线上面，下一点取下(x0+1,y0)
* `k>=1`
    * 设置起点(x0,y0)
    * 将中点(x0+0.5,y0+1)代入方程，算出中点与直线的距离d
    * d与0比较
        * 若`d<0`下一点取(x0+1,y0+1)
        * 若`d>=0`下一点取(x0,y0+1)

缺陷：
* 浮点数
* 乘法（求d）

优化：
* 增量思想，去乘法
    ![Pasted image 20230501015209](https://raw.githubusercontent.com/24849748/PicBed/main/ob/202306091024479.png)![Pasted image 20230501015228](https://raw.githubusercontent.com/24849748/PicBed/main/ob/202306091024466.png)![Pasted image 20230501015503](https://raw.githubusercontent.com/24849748/PicBed/main/ob/202306091024449.png)
* d与0比较，所以用2d也不影响结果



### 贝斯曼直线算法
![Pasted image 20230501020208](https://raw.githubusercontent.com/24849748/PicBed/main/ob/202306091024096.png)
理解：k是增量，d是误差项，初值为0，`d1=d0+k`，一旦`d>=1`，就减1，保证d在0~1之间
![Pasted image 20230501022013](https://raw.githubusercontent.com/24849748/PicBed/main/ob/202306091024709.png)
画点步骤：
* `k<1`
    1. 设置起点(x0,y0)，初始值d=0
    2. d=d+k
    3. 代入公式判断取值
    4. 如果`d>=1`，d-1
* `k>=1`
    1. 设置起点(x0,y0)，初始值d=0
    2. d=d+1/k
    3. 代入公式判断取值
    4. 如果`d>=1`，d-1

缺陷：还有浮点数

优化：
1. d初始值减0.5，从-0.5开始，后续开始就是跟0比较
2. 误差项只用到负号，所以可以从-1开始

# 代码实现

tocode：
1. 判断象限
2. 判断直线方向

